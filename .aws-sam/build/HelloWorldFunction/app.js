"use strict";var Ce=Object.defineProperty;var or=Object.getOwnPropertyDescriptor;var nr=Object.getOwnPropertyNames;var ir=Object.prototype.hasOwnProperty;var ar=(e,t,r)=>t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var cr=(e,t)=>{for(var r in t)Ce(e,r,{get:t[r],enumerable:!0})},lr=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of nr(t))!ir.call(e,o)&&o!==r&&Ce(e,o,{get:()=>t[o],enumerable:!(s=or(t,o))||s.enumerable});return e};var hr=e=>lr(Ce({},"__esModule",{value:!0}),e);var p=(e,t,r)=>(ar(e,typeof t!="symbol"?t+"":t,r),r),Je=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var i=(e,t,r)=>(Je(e,t,"read from private field"),r?r.call(e):t.get(e)),f=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},u=(e,t,r,s)=>(Je(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),mt=(e,t,r,s)=>({set _(o){u(e,t,o,r)},get _(){return i(e,t,s)}}),m=(e,t,r)=>(Je(e,t,"access private method"),r);var es={};cr(es,{default:()=>Zr,handler:()=>Xr});module.exports=hr(es);var We=(e,t,r)=>(s,o)=>{let n=-1;return c(0);async function c(l){if(l<=n)throw new Error("next() called multiple times");n=l;let a,h=!1,d;if(e[l]?(d=e[l][0][0],s.req.routeIndex=l):d=l===e.length&&o||void 0,d)try{a=await d(s,()=>c(l+1))}catch(g){if(g instanceof Error&&t)s.error=g,a=await t(g,s),h=!0;else throw g}else s.finalized===!1&&r&&(a=await r(s));return a&&(s.finalized===!1||h)&&(s.res=a),s}};var gt=async(e,t=Object.create(null))=>{let{all:r=!1,dot:s=!1}=t,n=(e instanceof $e?e.raw.headers:e.headers).get("Content-Type");return n?.startsWith("multipart/form-data")||n?.startsWith("application/x-www-form-urlencoded")?ur(e,{all:r,dot:s}):{}};async function ur(e,t){let r=await e.formData();return r?dr(r,t):{}}function dr(e,t){let r=Object.create(null);return e.forEach((s,o)=>{t.all||o.endsWith("[]")?fr(r,o,s):r[o]=s}),t.dot&&Object.entries(r).forEach(([s,o])=>{s.includes(".")&&(pr(r,s,o),delete r[s])}),r}var fr=(e,t,r)=>{e[t]!==void 0?Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r},pr=(e,t,r)=>{let s=e,o=t.split(".");o.forEach((n,c)=>{c===o.length-1?s[n]=r:((!s[n]||typeof s[n]!="object"||Array.isArray(s[n])||s[n]instanceof File)&&(s[n]=Object.create(null)),s=s[n])})};var Ye=e=>{let t=e.split("/");return t[0]===""&&t.shift(),t},yt=e=>{let{groups:t,path:r}=mr(e),s=Ye(r);return gr(s,t)},mr=e=>{let t=[];return e=e.replace(/\{[^}]+\}/g,(r,s)=>{let o=`@${s}`;return t.push([o,r]),o}),{groups:t,path:e}},gr=(e,t)=>{for(let r=t.length-1;r>=0;r--){let[s]=t[r];for(let o=e.length-1;o>=0;o--)if(e[o].includes(s)){e[o]=e[o].replace(s,t[r][1]);break}}return e},_e={},Xe=(e,t)=>{if(e==="*")return"*";let r=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(r){let s=`${e}#${t}`;return _e[s]||(r[2]?_e[s]=t&&t[0]!==":"&&t[0]!=="*"?[s,r[1],new RegExp(`^${r[2]}(?=/${t})`)]:[e,r[1],new RegExp(`^${r[2]}$`)]:_e[s]=[e,r[1],!0]),_e[s]}return null},Ze=(e,t)=>{try{return t(e)}catch{return e.replace(/(?:%[0-9A-Fa-f]{2})+/g,r=>{try{return t(r)}catch{return r}})}},yr=e=>Ze(e,decodeURI),et=e=>{let t=e.url,r=t.indexOf("/",8),s=r;for(;s<t.length;s++){let o=t.charCodeAt(s);if(o===37){let n=t.indexOf("?",s),c=t.slice(r,n===-1?void 0:n);return yr(c.includes("%25")?c.replace(/%25/g,"%2525"):c)}else if(o===63)break}return t.slice(r,s)};var wt=e=>{let t=et(e);return t.length>1&&t.at(-1)==="/"?t.slice(0,-1):t},Z=(e,t,...r)=>(r.length&&(t=Z(t,...r)),`${e?.[0]==="/"?"":"/"}${e}${t==="/"?"":`${e?.at(-1)==="/"?"":"/"}${t?.[0]==="/"?t.slice(1):t}`}`),He=e=>{if(e.charCodeAt(e.length-1)!==63||!e.includes(":"))return null;let t=e.split("/"),r=[],s="";return t.forEach(o=>{if(o!==""&&!/\:/.test(o))s+="/"+o;else if(/\:/.test(o))if(/\?/.test(o)){r.length===0&&s===""?r.push("/"):r.push(s);let n=o.replace("?","");s+="/"+n,r.push(s)}else s+="/"+o}),r.filter((o,n,c)=>c.indexOf(o)===n)},Ke=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")!==-1?tt(e):e):e,bt=(e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let c=e.indexOf(`?${t}`,8);for(c===-1&&(c=e.indexOf(`&${t}`,8));c!==-1;){let l=e.charCodeAt(c+t.length+1);if(l===61){let a=c+t.length+2,h=e.indexOf("&",a);return Ke(e.slice(a,h===-1?void 0:h))}else if(l==38||isNaN(l))return"";c=e.indexOf(`&${t}`,c+1)}if(s=/[%+]/.test(e),!s)return}let o={};s??(s=/[%+]/.test(e));let n=e.indexOf("?",8);for(;n!==-1;){let c=e.indexOf("&",n+1),l=e.indexOf("=",n);l>c&&c!==-1&&(l=-1);let a=e.slice(n+1,l===-1?c===-1?void 0:c:l);if(s&&(a=Ke(a)),n=c,a==="")continue;let h;l===-1?h="":(h=e.slice(l+1,c===-1?void 0:c),s&&(h=Ke(h))),r?(o[a]&&Array.isArray(o[a])||(o[a]=[]),o[a].push(h)):o[a]??(o[a]=h)}return t?o[t]:o},Et=bt,xt=(e,t)=>bt(e,t,!0),tt=decodeURIComponent;var Rt=e=>Ze(e,tt),ae,T,ke,jt,Te,Pt,ye,rt,J,vt,$e=(vt=class{constructor(e,t="/",r=[[]]){f(this,ke);f(this,Te);f(this,ye);p(this,"raw");f(this,ae,void 0);f(this,T,void 0);p(this,"routeIndex",0);p(this,"path");p(this,"bodyCache",{});f(this,J,e=>{let{bodyCache:t,raw:r}=this,s=t[e];if(s)return s;let o=Object.keys(t)[0];return o?t[o].then(n=>(o==="json"&&(n=JSON.stringify(n)),new Response(n)[e]())):t[e]=r[e]()});this.raw=e,this.path=t,u(this,T,r),u(this,ae,{})}param(e){return e?m(this,ke,jt).call(this,e):m(this,Te,Pt).call(this)}query(e){return Et(this.url,e)}queries(e){return xt(this.url,e)}header(e){if(e)return this.raw.headers.get(e)??void 0;let t={};return this.raw.headers.forEach((r,s)=>{t[s]=r}),t}async parseBody(e){var t;return(t=this.bodyCache).parsedBody??(t.parsedBody=await gt(this,e))}json(){return i(this,J).call(this,"json")}text(){return i(this,J).call(this,"text")}arrayBuffer(){return i(this,J).call(this,"arrayBuffer")}blob(){return i(this,J).call(this,"blob")}formData(){return i(this,J).call(this,"formData")}addValidatedData(e,t){i(this,ae)[e]=t}valid(e){return i(this,ae)[e]}get url(){return this.raw.url}get method(){return this.raw.method}get matchedRoutes(){return i(this,T)[0].map(([[,e]])=>e)}get routePath(){return i(this,T)[0].map(([[,e]])=>e)[this.routeIndex].path}},ae=new WeakMap,T=new WeakMap,ke=new WeakSet,jt=function(e){let t=i(this,T)[0][this.routeIndex][1][e],r=m(this,ye,rt).call(this,t);return r?/\%/.test(r)?Rt(r):r:void 0},Te=new WeakSet,Pt=function(){let e={},t=Object.keys(i(this,T)[0][this.routeIndex][1]);for(let r of t){let s=m(this,ye,rt).call(this,i(this,T)[0][this.routeIndex][1][r]);s&&typeof s=="string"&&(e[r]=/\%/.test(s)?Rt(s):s)}return e},ye=new WeakSet,rt=function(e){return i(this,T)[1]?i(this,T)[1][e]:e},J=new WeakMap,vt);var St={Stringify:1,BeforeStream:2,Stream:3},wr=(e,t)=>{let r=new String(e);return r.isEscaped=!0,r.callbacks=t,r};var st=async(e,t,r,s,o)=>{typeof e=="object"&&!(e instanceof String)&&(e instanceof Promise||(e=e.toString()),e instanceof Promise&&(e=await e));let n=e.callbacks;if(!n?.length)return Promise.resolve(e);o?o[0]+=e:o=[e];let c=Promise.all(n.map(l=>l({phase:t,buffer:o,context:s}))).then(l=>Promise.all(l.filter(Boolean).map(a=>st(a,t,!1,s,o))).then(()=>o[0]));return r?wr(await c,n):c};var br="text/plain; charset=UTF-8",ot=(e,t={})=>{for(let r of Object.keys(t))e.set(r,t[r]);return e},we,be,I,ee,M,b,x,$,D,Ee,ce,le,xe,Re,A,_,Ot,At=(Ot=class{constructor(e,t){f(this,A);f(this,we,void 0);f(this,be,void 0);p(this,"env",{});f(this,I,void 0);p(this,"finalized",!1);p(this,"error");f(this,ee,200);f(this,M,void 0);f(this,b,void 0);f(this,x,void 0);f(this,$,void 0);f(this,D,!0);f(this,Ee,void 0);f(this,ce,void 0);f(this,le,void 0);f(this,xe,void 0);f(this,Re,void 0);p(this,"render",(...e)=>(i(this,ce)??u(this,ce,t=>this.html(t)),i(this,ce).call(this,...e)));p(this,"setLayout",e=>u(this,Ee,e));p(this,"getLayout",()=>i(this,Ee));p(this,"setRenderer",e=>{u(this,ce,e)});p(this,"header",(e,t,r)=>{if(this.finalized&&u(this,$,new Response(i(this,$).body,i(this,$))),t===void 0){i(this,b)?i(this,b).delete(e):i(this,x)&&delete i(this,x)[e.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(e);return}r?.append?(i(this,b)||(u(this,D,!1),u(this,b,new Headers(i(this,x))),u(this,x,{})),i(this,b).append(e,t)):i(this,b)?i(this,b).set(e,t):(i(this,x)??u(this,x,{}),i(this,x)[e.toLowerCase()]=t),this.finalized&&(r?.append?this.res.headers.append(e,t):this.res.headers.set(e,t))});p(this,"status",e=>{u(this,D,!1),u(this,ee,e)});p(this,"set",(e,t)=>{i(this,I)??u(this,I,new Map),i(this,I).set(e,t)});p(this,"get",e=>i(this,I)?i(this,I).get(e):void 0);p(this,"newResponse",(...e)=>m(this,A,_).call(this,...e));p(this,"body",(e,t,r)=>typeof t=="number"?m(this,A,_).call(this,e,t,r):m(this,A,_).call(this,e,t));p(this,"text",(e,t,r)=>{if(!i(this,x)){if(i(this,D)&&!r&&!t)return new Response(e);u(this,x,{})}return i(this,x)["content-type"]=br,typeof t=="number"?m(this,A,_).call(this,e,t,r):m(this,A,_).call(this,e,t)});p(this,"json",(e,t,r)=>{let s=JSON.stringify(e);return i(this,x)??u(this,x,{}),i(this,x)["content-type"]="application/json",typeof t=="number"?m(this,A,_).call(this,s,t,r):m(this,A,_).call(this,s,t)});p(this,"html",(e,t,r)=>(i(this,x)??u(this,x,{}),i(this,x)["content-type"]="text/html; charset=UTF-8",typeof e=="object"?st(e,St.Stringify,!1,{}).then(s=>typeof t=="number"?m(this,A,_).call(this,s,t,r):m(this,A,_).call(this,s,t)):typeof t=="number"?m(this,A,_).call(this,e,t,r):m(this,A,_).call(this,e,t)));p(this,"redirect",(e,t)=>(i(this,b)??u(this,b,new Headers),i(this,b).set("Location",String(e)),this.newResponse(null,t??302)));p(this,"notFound",()=>(i(this,le)??u(this,le,()=>new Response),i(this,le).call(this,this)));u(this,we,e),t&&(u(this,M,t.executionCtx),this.env=t.env,u(this,le,t.notFoundHandler),u(this,Re,t.path),u(this,xe,t.matchResult))}get req(){return i(this,be)??u(this,be,new $e(i(this,we),i(this,Re),i(this,xe))),i(this,be)}get event(){if(i(this,M)&&"respondWith"in i(this,M))return i(this,M);throw Error("This context has no FetchEvent")}get executionCtx(){if(i(this,M))return i(this,M);throw Error("This context has no ExecutionContext")}get res(){return u(this,D,!1),i(this,$)||u(this,$,new Response("404 Not Found",{status:404}))}set res(e){if(u(this,D,!1),i(this,$)&&e){e=new Response(e.body,e);for(let[t,r]of i(this,$).headers.entries())if(t!=="content-type")if(t==="set-cookie"){let s=i(this,$).headers.getSetCookie();e.headers.delete("set-cookie");for(let o of s)e.headers.append("set-cookie",o)}else e.headers.set(t,r)}u(this,$,e),this.finalized=!0}get var(){return i(this,I)?Object.fromEntries(i(this,I)):{}}},we=new WeakMap,be=new WeakMap,I=new WeakMap,ee=new WeakMap,M=new WeakMap,b=new WeakMap,x=new WeakMap,$=new WeakMap,D=new WeakMap,Ee=new WeakMap,ce=new WeakMap,le=new WeakMap,xe=new WeakMap,Re=new WeakMap,A=new WeakSet,_=function(e,t,r){if(i(this,D)&&!r&&!t&&i(this,ee)===200)return new Response(e,{headers:i(this,x)});if(t&&typeof t!="number"){let o=new Headers(t.headers);i(this,b)&&i(this,b).forEach((c,l)=>{l==="set-cookie"?o.append(l,c):o.set(l,c)});let n=ot(o,i(this,x));return new Response(e,{headers:n,status:t.status??i(this,ee)})}let s=typeof t=="number"?t:i(this,ee);i(this,x)??u(this,x,{}),i(this,b)??u(this,b,new Headers),ot(i(this,b),i(this,x)),i(this,$)&&(i(this,$).headers.forEach((o,n)=>{n==="set-cookie"?i(this,b)?.append(n,o):i(this,b)?.set(n,o)}),ot(i(this,b),i(this,x))),r??(r={});for(let[o,n]of Object.entries(r))if(typeof n=="string")i(this,b).set(o,n);else{i(this,b).delete(o);for(let c of n)i(this,b).append(o,c)}return new Response(e,{status:s,headers:i(this,b)})},Ot);var E="ALL",Ct="all",$t=["get","post","put","delete","options","patch"],qe="Can not add a route since the matcher is already built.",Ne=class extends Error{};var _t="__COMPOSED_HANDLER";var Er=e=>e.text("404 Not Found",404),Ht=(e,t)=>"getResponse"in e?e.getResponse():(console.error(e),t.text("Internal Server Error",500)),q,Ie,Tt,U,V,te,he,Be,ue,Le,kt,nt=(kt=class{constructor(e={}){f(this,Ie);f(this,V);f(this,he);f(this,ue);p(this,"get");p(this,"post");p(this,"put");p(this,"delete");p(this,"options");p(this,"patch");p(this,"all");p(this,"on");p(this,"use");p(this,"router");p(this,"getPath");p(this,"_basePath","/");f(this,q,"/");p(this,"routes",[]);f(this,U,Er);p(this,"errorHandler",Ht);p(this,"onError",e=>(this.errorHandler=e,this));p(this,"notFound",e=>(u(this,U,e),this));p(this,"fetch",(e,...t)=>m(this,ue,Le).call(this,e,t[1],t[0],e.method));p(this,"request",(e,t,r,s)=>e instanceof Request?this.fetch(t?new Request(e,t):e,r,s):(e=e.toString(),this.fetch(new Request(/^https?:\/\//.test(e)?e:`http://localhost${Z("/",e)}`,t),r,s)));p(this,"fire",()=>{addEventListener("fetch",e=>{e.respondWith(m(this,ue,Le).call(this,e.request,e,void 0,e.request.method))})});[...$t,Ct].forEach(o=>{this[o]=(n,...c)=>(typeof n=="string"?u(this,q,n):m(this,V,te).call(this,o,i(this,q),n),c.forEach(l=>{m(this,V,te).call(this,o,i(this,q),l)}),this)}),this.on=(o,n,...c)=>{for(let l of[n].flat()){u(this,q,l);for(let a of[o].flat())c.map(h=>{m(this,V,te).call(this,a.toUpperCase(),i(this,q),h)})}return this},this.use=(o,...n)=>(typeof o=="string"?u(this,q,o):(u(this,q,"*"),n.unshift(o)),n.forEach(c=>{m(this,V,te).call(this,E,i(this,q),c)}),this);let{strict:r,...s}=e;Object.assign(this,s),this.getPath=r??!0?e.getPath??et:wt}route(e,t){let r=this.basePath(e);return t.routes.map(s=>{var n;let o;t.errorHandler===Ht?o=s.handler:(o=async(c,l)=>(await We([],t.errorHandler)(c,()=>s.handler(c,l))).res,o[_t]=s.handler),m(n=r,V,te).call(n,s.method,s.path,o)}),this}basePath(e){let t=m(this,Ie,Tt).call(this);return t._basePath=Z(this._basePath,e),t}mount(e,t,r){let s,o;r&&(typeof r=="function"?o=r:(o=r.optionHandler,r.replaceRequest===!1?s=l=>l:s=r.replaceRequest));let n=o?l=>{let a=o(l);return Array.isArray(a)?a:[a]}:l=>{let a;try{a=l.executionCtx}catch{}return[l.env,a]};s||(s=(()=>{let l=Z(this._basePath,e),a=l==="/"?0:l.length;return h=>{let d=new URL(h.url);return d.pathname=d.pathname.slice(a)||"/",new Request(d,h)}})());let c=async(l,a)=>{let h=await t(s(l.req.raw),...n(l));if(h)return h;await a()};return m(this,V,te).call(this,E,Z(e,"*"),c),this}},q=new WeakMap,Ie=new WeakSet,Tt=function(){let e=new nt({router:this.router,getPath:this.getPath});return e.routes=this.routes,e},U=new WeakMap,V=new WeakSet,te=function(e,t,r){e=e.toUpperCase(),t=Z(this._basePath,t);let s={path:t,method:e,handler:r};this.router.add(e,t,[r,s]),this.routes.push(s)},he=new WeakSet,Be=function(e,t){if(e instanceof Error)return this.errorHandler(e,t);throw e},ue=new WeakSet,Le=function(e,t,r,s){if(s==="HEAD")return(async()=>new Response(null,await m(this,ue,Le).call(this,e,t,r,"GET")))();let o=this.getPath(e,{env:r}),n=this.router.match(s,o),c=new At(e,{path:o,matchResult:n,env:r,executionCtx:t,notFoundHandler:i(this,U)});if(n[0].length===1){let a;try{a=n[0][0][0][0](c,async()=>{c.res=await i(this,U).call(this,c)})}catch(h){return m(this,he,Be).call(this,h,c)}return a instanceof Promise?a.then(h=>h||(c.finalized?c.res:i(this,U).call(this,c))).catch(h=>m(this,he,Be).call(this,h,c)):a??i(this,U).call(this,c)}let l=We(n[0],this.errorHandler,i(this,U));return(async()=>{try{let a=await l(c);if(!a.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return a.res}catch(a){return m(this,he,Be).call(this,a,c)}})()},kt);var Me="[^/]+",ve=".*",je="(?:|/.*)",de=Symbol(),xr=new Set(".\\+*[^]$()");function Rr(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===ve||e===je?1:t===ve||t===je?-1:e===Me?1:t===Me?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var re,se,N,qt,De=(qt=class{constructor(){f(this,re,void 0);f(this,se,void 0);f(this,N,Object.create(null))}insert(e,t,r,s,o){if(e.length===0){if(i(this,re)!==void 0)throw de;if(o)return;u(this,re,t);return}let[n,...c]=e,l=n==="*"?c.length===0?["","",ve]:["","",Me]:n==="/*"?["","",je]:n.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),a;if(l){let h=l[1],d=l[2]||Me;if(h&&l[2]&&(d=d.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(d)))throw de;if(a=i(this,N)[d],!a){if(Object.keys(i(this,N)).some(g=>g!==ve&&g!==je))throw de;if(o)return;a=i(this,N)[d]=new De,h!==""&&u(a,se,s.varIndex++)}!o&&h!==""&&r.push([h,i(a,se)])}else if(a=i(this,N)[n],!a){if(Object.keys(i(this,N)).some(h=>h.length>1&&h!==ve&&h!==je))throw de;if(o)return;a=i(this,N)[n]=new De}a.insert(c,t,r,s,o)}buildRegExpStr(){let t=Object.keys(i(this,N)).sort(Rr).map(r=>{let s=i(this,N)[r];return(typeof i(s,se)=="number"?`(${r})@${i(s,se)}`:xr.has(r)?`\\${r}`:r)+s.buildRegExpStr()});return typeof i(this,re)=="number"&&t.unshift(`#${i(this,re)}`),t.length===0?"":t.length===1?t[0]:"(?:"+t.join("|")+")"}},re=new WeakMap,se=new WeakMap,N=new WeakMap,qt);var Ue,Pe,Nt,Bt=(Nt=class{constructor(){f(this,Ue,{varIndex:0});f(this,Pe,new De)}insert(e,t,r){let s=[],o=[];for(let c=0;;){let l=!1;if(e=e.replace(/\{[^}]+\}/g,a=>{let h=`@\\${c}`;return o[c]=[h,a],c++,l=!0,h}),!l)break}let n=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let c=o.length-1;c>=0;c--){let[l]=o[c];for(let a=n.length-1;a>=0;a--)if(n[a].indexOf(l)!==-1){n[a]=n[a].replace(l,o[c][1]);break}}return i(this,Pe).insert(n,t,s,i(this,Ue),r),s}buildRegExp(){let e=i(this,Pe).buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0,r=[],s=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(o,n,c)=>n!==void 0?(r[++t]=Number(n),"$()"):(c!==void 0&&(s[Number(c)]=++t),"")),[new RegExp(`^${e}`),r,s]}},Ue=new WeakMap,Pe=new WeakMap,Nt);var It=[],vr=[/^$/,[],Object.create(null)],Ve=Object.create(null);function Mt(e){return Ve[e]??(Ve[e]=new RegExp(e==="*"?"":`^${e.replace(/\/\*$|([.\\+*[^\]$()])/g,(t,r)=>r?`\\${r}`:"(?:|/.*)")}$`))}function jr(){Ve=Object.create(null)}function Pr(e){let t=new Bt,r=[];if(e.length===0)return vr;let s=e.map(h=>[!/\*|\/:/.test(h[0]),...h]).sort(([h,d],[g,y])=>h?1:g?-1:d.length-y.length),o=Object.create(null);for(let h=0,d=-1,g=s.length;h<g;h++){let[y,R,w]=s[h];y?o[R]=[w.map(([S])=>[S,Object.create(null)]),It]:d++;let j;try{j=t.insert(R,d,y)}catch(S){throw S===de?new Ne(R):S}y||(r[d]=w.map(([S,Q])=>{let G=Object.create(null);for(Q-=1;Q>=0;Q--){let[O,me]=j[Q];G[O]=me}return[S,G]}))}let[n,c,l]=t.buildRegExp();for(let h=0,d=r.length;h<d;h++)for(let g=0,y=r[h].length;g<y;g++){let R=r[h][g]?.[1];if(!R)continue;let w=Object.keys(R);for(let j=0,S=w.length;j<S;j++)R[w[j]]=l[R[w[j]]]}let a=[];for(let h in c)a[h]=r[c[h]];return[n,a,o]}function fe(e,t){if(!!e){for(let r of Object.keys(e).sort((s,o)=>o.length-s.length))if(Mt(r).test(t))return[...e[r]]}}var W,K,ze,Dt,Fe,Ut,Lt,it=(Lt=class{constructor(){f(this,ze);f(this,Fe);p(this,"name","RegExpRouter");f(this,W,void 0);f(this,K,void 0);u(this,W,{[E]:Object.create(null)}),u(this,K,{[E]:Object.create(null)})}add(e,t,r){var l;let s=i(this,W),o=i(this,K);if(!s||!o)throw new Error(qe);s[e]||[s,o].forEach(a=>{a[e]=Object.create(null),Object.keys(a[E]).forEach(h=>{a[e][h]=[...a[E][h]]})}),t==="/*"&&(t="*");let n=(t.match(/\/:/g)||[]).length;if(/\*$/.test(t)){let a=Mt(t);e===E?Object.keys(s).forEach(h=>{var d;(d=s[h])[t]||(d[t]=fe(s[h],t)||fe(s[E],t)||[])}):(l=s[e])[t]||(l[t]=fe(s[e],t)||fe(s[E],t)||[]),Object.keys(s).forEach(h=>{(e===E||e===h)&&Object.keys(s[h]).forEach(d=>{a.test(d)&&s[h][d].push([r,n])})}),Object.keys(o).forEach(h=>{(e===E||e===h)&&Object.keys(o[h]).forEach(d=>a.test(d)&&o[h][d].push([r,n]))});return}let c=He(t)||[t];for(let a=0,h=c.length;a<h;a++){let d=c[a];Object.keys(o).forEach(g=>{var y;(e===E||e===g)&&((y=o[g])[d]||(y[d]=[...fe(s[g],d)||fe(s[E],d)||[]]),o[g][d].push([r,n-h+a+1]))})}}match(e,t){jr();let r=m(this,ze,Dt).call(this);return this.match=(s,o)=>{let n=r[s]||r[E],c=n[2][o];if(c)return c;let l=o.match(n[0]);if(!l)return[[],It];let a=l.indexOf("",1);return[n[1][a],l]},this.match(e,t)}},W=new WeakMap,K=new WeakMap,ze=new WeakSet,Dt=function(){let e=Object.create(null);return Object.keys(i(this,K)).concat(Object.keys(i(this,W))).forEach(t=>{e[t]||(e[t]=m(this,Fe,Ut).call(this,t))}),u(this,W,u(this,K,void 0)),e},Fe=new WeakSet,Ut=function(e){let t=[],r=e===E;return[i(this,W),i(this,K)].forEach(s=>{let o=s[e]?Object.keys(s[e]).map(n=>[n,s[e][n]]):[];o.length!==0?(r||(r=!0),t.push(...o)):e!==E&&t.push(...Object.keys(s[E]).map(n=>[n,s[E][n]]))}),r?Pr(t):null},Lt);var Y,z,Vt,at=(Vt=class{constructor(e){p(this,"name","SmartRouter");f(this,Y,[]);f(this,z,[]);u(this,Y,e.routers)}add(e,t,r){if(!i(this,z))throw new Error(qe);i(this,z).push([e,t,r])}match(e,t){if(!i(this,z))throw new Error("Fatal error");let r=i(this,Y),s=i(this,z),o=r.length,n=0,c;for(;n<o;n++){let l=r[n];try{for(let a=0,h=s.length;a<h;a++)l.add(...s[a]);c=l.match(e,t)}catch(a){if(a instanceof Ne)continue;throw a}this.match=l.match.bind(l),u(this,Y,[l]),u(this,z,void 0);break}if(n===o)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,c}get activeRouter(){if(i(this,z)||i(this,Y).length!==1)throw new Error("No active router has been determined yet.");return i(this,Y)[0]}},Y=new WeakMap,z=new WeakMap,Vt);var Se=Object.create(null),X,P,ne,pe,v,F,oe,zt,ct=(zt=class{constructor(e,t,r){f(this,F);f(this,X,void 0);f(this,P,void 0);f(this,ne,void 0);f(this,pe,0);f(this,v,Se);if(u(this,P,r||Object.create(null)),u(this,X,[]),e&&t){let s=Object.create(null);s[e]={handler:t,possibleKeys:[],score:0},u(this,X,[s])}u(this,ne,[])}insert(e,t,r){u(this,pe,++mt(this,pe)._);let s=this,o=yt(t),n=[];for(let a=0,h=o.length;a<h;a++){let d=o[a],g=o[a+1],y=Xe(d,g),R=Array.isArray(y)?y[0]:d;if(Object.keys(i(s,P)).includes(R)){s=i(s,P)[R];let w=Xe(d,g);w&&n.push(w[1]);continue}i(s,P)[R]=new ct,y&&(i(s,ne).push(y),n.push(y[1])),s=i(s,P)[R]}let c=Object.create(null),l={handler:r,possibleKeys:n.filter((a,h,d)=>d.indexOf(a)===h),score:i(this,pe)};return c[e]=l,i(s,X).push(c),s}search(e,t){let r=[];u(this,v,Se);let o=[this],n=Ye(t),c=[];for(let l=0,a=n.length;l<a;l++){let h=n[l],d=l===a-1,g=[];for(let y=0,R=o.length;y<R;y++){let w=o[y],j=i(w,P)[h];j&&(u(j,v,i(w,v)),d?(i(j,P)["*"]&&r.push(...m(this,F,oe).call(this,i(j,P)["*"],e,i(w,v))),r.push(...m(this,F,oe).call(this,j,e,i(w,v)))):g.push(j));for(let S=0,Q=i(w,ne).length;S<Q;S++){let G=i(w,ne)[S],O=i(w,v)===Se?{}:{...i(w,v)};if(G==="*"){let k=i(w,P)["*"];k&&(r.push(...m(this,F,oe).call(this,k,e,i(w,v))),u(k,v,O),g.push(k));continue}if(h==="")continue;let[me,Ae,L]=G,H=i(w,P)[me],Qe=n.slice(l).join("/");if(L instanceof RegExp){let k=L.exec(Qe);if(k){if(O[Ae]=k[0],r.push(...m(this,F,oe).call(this,H,e,i(w,v),O)),Object.keys(i(H,P)).length){u(H,v,O);let ge=k[0].match(/\//)?.length??0;(c[ge]||(c[ge]=[])).push(H)}continue}}(L===!0||L.test(h))&&(O[Ae]=h,d?(r.push(...m(this,F,oe).call(this,H,e,O,i(w,v))),i(H,P)["*"]&&r.push(...m(this,F,oe).call(this,i(H,P)["*"],e,O,i(w,v)))):(u(H,v,O),g.push(H)))}}o=g.concat(c.shift()??[])}return r.length>1&&r.sort((l,a)=>l.score-a.score),[r.map(({handler:l,params:a})=>[l,a])]}},X=new WeakMap,P=new WeakMap,ne=new WeakMap,pe=new WeakMap,v=new WeakMap,F=new WeakSet,oe=function(e,t,r,s){let o=[];for(let n=0,c=i(e,X).length;n<c;n++){let l=i(e,X)[n],a=l[t]||l[E],h={};if(a!==void 0&&(a.params=Object.create(null),o.push(a),r!==Se||s&&s!==Se))for(let d=0,g=a.possibleKeys.length;d<g;d++){let y=a.possibleKeys[d],R=h[a.score];a.params[y]=s?.[y]&&!R?s[y]:r[y]??s?.[y],h[a.score]=!0}}return o},zt);var ie,Ft,lt=(Ft=class{constructor(){p(this,"name","TrieRouter");f(this,ie,void 0);u(this,ie,new ct)}add(e,t,r){let s=He(t);if(s){for(let o=0,n=s.length;o<n;o++)i(this,ie).insert(e,s[o],r);return}i(this,ie).insert(e,t,r)}match(e,t){return i(this,ie).search(e,t)}},ie=new WeakMap,Ft);var ht=class extends nt{constructor(e={}){super(e),this.router=e.router??new at({routers:[new it,new lt]})}};var Qt=e=>{let t="",r=new Uint8Array(e);for(let s=0,o=r.length;s<o;s++)t+=String.fromCharCode(r[s]);return btoa(t)},Gt=e=>{let t=atob(e),r=new Uint8Array(new ArrayBuffer(t.length)),s=t.length/2;for(let o=0,n=t.length-1;o<=s;o++,n--)r[o]=t.charCodeAt(o),r[n]=t.charCodeAt(n);return r};var Sr=e=>e.requestContext;var ut=e=>async(t,r)=>{let s=kr(t),o=s.createRequest(t),n=Sr(t),c=await e.fetch(o,{event:t,requestContext:n,lambdaContext:r});return s.createResult(t,c)},dt=class{createRequest(e){let t=this.getQueryString(e),r=e.requestContext&&"domainName"in e.requestContext?e.requestContext.domainName:e.headers?.host??e.multiValueHeaders?.host?.[0],s=this.getPath(e),o=`https://${r}${s}`,n=t?`${o}?${t}`:o,c=this.getHeaders(e),l=this.getMethod(e),a={headers:c,method:l};return e.body&&(a.body=e.isBase64Encoded?Gt(e.body):e.body),new Request(n,a)}async createResult(e,t){let r=t.headers.get("content-type"),s=!!(r&&Nr(r));if(!s){let c=t.headers.get("content-encoding");s=Br(c)}let n={body:s?Qt(await t.arrayBuffer()):await t.text(),statusCode:t.status,isBase64Encoded:s,...e.multiValueHeaders?{multiValueHeaders:{}}:{headers:{}}};return this.setCookies(e,t,n),n.multiValueHeaders?t.headers.forEach((c,l)=>{n.multiValueHeaders[l]=[c]}):t.headers.forEach((c,l)=>{n.headers[l]=c}),n}setCookies(e,t,r){if(t.headers.has("set-cookie")){let s=t.headers.getSetCookie?t.headers.getSetCookie():Array.from(t.headers.entries()).filter(([o])=>o==="set-cookie").map(([,o])=>o);Array.isArray(s)&&(this.setCookiesToResult(r,s),t.headers.delete("set-cookie"))}}},Or=class extends dt{getPath(e){return e.rawPath}getMethod(e){return e.requestContext.http.method}getQueryString(e){return e.rawQueryString}getCookies(e,t){Array.isArray(e.cookies)&&t.set("Cookie",e.cookies.join("; "))}setCookiesToResult(e,t){e.cookies=t}getHeaders(e){let t=new Headers;if(this.getCookies(e,t),e.headers)for(let[r,s]of Object.entries(e.headers))s&&t.set(r,s);return t}},Ar=new Or,Cr=class extends dt{getPath(e){return e.path}getMethod(e){return e.httpMethod}getQueryString(e){return e.multiValueQueryStringParameters?Object.entries(e.multiValueQueryStringParameters||{}).filter(([,t])=>t).map(([t,r])=>`${t}=${r.join(`&${t}=`)}`).join("&"):Object.entries(e.queryStringParameters||{}).filter(([,t])=>t).map(([t,r])=>`${t}=${r}`).join("&")}getCookies(e,t){}getHeaders(e){let t=new Headers;if(this.getCookies(e,t),e.headers)for(let[r,s]of Object.entries(e.headers))s&&t.set(r,s);if(e.multiValueHeaders){for(let[r,s]of Object.entries(e.multiValueHeaders))if(s){let o=t.get(r);s.forEach(n=>(!o||!o.includes(n))&&t.append(r,n))}}return t}setCookiesToResult(e,t){e.multiValueHeaders={"set-cookie":t}}},$r=new Cr,_r=class extends dt{getHeaders(e){let t=new Headers;if(e.multiValueHeaders)for(let[r,s]of Object.entries(e.multiValueHeaders))s&&Array.isArray(s)&&t.set(r,s.join("; "));else for(let[r,s]of Object.entries(e.headers??{}))s&&t.set(r,s);return t}getPath(e){return e.path}getMethod(e){return e.httpMethod}getQueryString(e){return e.multiValueQueryStringParameters?Object.entries(e.multiValueQueryStringParameters||{}).filter(([,t])=>t).map(([t,r])=>`${t}=${r.join(`&${t}=`)}`).join("&"):Object.entries(e.queryStringParameters||{}).filter(([,t])=>t).map(([t,r])=>`${t}=${r}`).join("&")}getCookies(e,t){let r;e.multiValueHeaders?r=e.multiValueHeaders.cookie?.join("; "):r=e.headers?e.headers.cookie:void 0,r&&t.append("Cookie",r)}setCookiesToResult(e,t){e.multiValueHeaders?e.multiValueHeaders["set-cookie"]=t:e.headers["set-cookie"]=t.join(", ")}},Hr=new _r,kr=e=>Tr(e)?Hr:qr(e)?Ar:$r,Tr=e=>e.requestContext?Object.hasOwn(e.requestContext,"elb"):!1,qr=e=>Object.hasOwn(e,"rawPath"),Nr=e=>!/^(text\/(plain|html|css|javascript|csv).*|application\/(.*json|.*xml).*|image\/svg\+xml.*)$/.test(e),Br=e=>e===null?!1:/^(gzip|deflate|compress|br)/.test(e);var Jt=e=>{let r={...{origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[]},...e},s=(o=>typeof o=="string"?o==="*"?()=>o:n=>o===n?n:null:typeof o=="function"?o:n=>o.includes(n)?n:null)(r.origin);return async function(n,c){function l(h,d){n.res.headers.set(h,d)}let a=s(n.req.header("origin")||"",n);if(a&&l("Access-Control-Allow-Origin",a),r.origin!=="*"){let h=n.req.header("Vary");h?l("Vary",h):l("Vary","Origin")}if(r.credentials&&l("Access-Control-Allow-Credentials","true"),r.exposeHeaders?.length&&l("Access-Control-Expose-Headers",r.exposeHeaders.join(",")),n.req.method==="OPTIONS"){r.maxAge!=null&&l("Access-Control-Max-Age",r.maxAge.toString()),r.allowMethods?.length&&l("Access-Control-Allow-Methods",r.allowMethods.join(","));let h=r.allowHeaders;if(!h?.length){let d=n.req.header("Access-Control-Request-Headers");d&&(h=d.split(/\s*,\s*/))}return h?.length&&(l("Access-Control-Allow-Headers",h.join(",")),n.res.headers.append("Vary","Access-Control-Request-Headers")),n.res.headers.delete("Content-Length"),n.res.headers.delete("Content-Type"),new Response(null,{headers:n.res.headers,status:204,statusText:"No Content"})}await c()}};function Wt(){let{process:e,Deno:t}=globalThis;return!(typeof t?.noColor=="boolean"?t.noColor:e!==void 0?"NO_COLOR"in e?.env:!1)}var Lr=e=>{let[t,r]=[",","."];return e.map(o=>o.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t)).join(r)},Ir=e=>{let t=Date.now()-e;return Lr([t<1e3?t+"ms":Math.round(t/1e3)+"s"])},Mr=e=>{if(Wt())switch(e/100|0){case 5:return`\x1B[31m${e}\x1B[0m`;case 4:return`\x1B[33m${e}\x1B[0m`;case 3:return`\x1B[36m${e}\x1B[0m`;case 2:return`\x1B[32m${e}\x1B[0m`}return`${e}`};function Kt(e,t,r,s,o=0,n){let c=t==="<--"?`${t} ${r} ${s}`:`${t} ${r} ${s} ${Mr(o)} ${n}`;e(c)}var Yt=(e=console.log)=>async function(r,s){let{method:o,url:n}=r.req,c=n.slice(n.indexOf("/",8));Kt(e,"<--",o,c);let l=Date.now();await s(),Kt(e,"-->",o,c,r.res.status,Ir(l))};var Dr="gnti7y5zkih9elje0lzd4b84g",Ur="7ca33bfaf9ce41fbbc43a2abeec4e53d",Vr="79b0572f34084761b508cbca34bd3512",zr="AQDbn04HT4tNMovNt2r3j_xiNOz2qJPXrsIszfJEH7MfEQCR2ZBGsk9vrBeYosvqfy92UM2ciFLONzwd3K8J63wklBh9NBGfIypgOg-wgRpjGiYuPYD6gc933gNR_TpnhNU",Xt=Dr,Fr=Ur,Qr=Vr,B="",Gr=Buffer.from(`${Fr}:${Qr}`).toString("base64"),Jr={Authorization:`Basic ${Gr}`,"Content-Type":"application/x-www-form-urlencoded"},Wr=new URLSearchParams({grant_type:"refresh_token",refresh_token:zr});async function Oe(){return B=(await(await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:Jr,body:Wr})).json()).access_token}async function ft(e){try{await Oe(),console.log(e);let t;e.setlist_name?t=e.setlist_name:e.event_date?t=`${e.artist_name} - ${e.event_date.toISOString().split("T")[0]}`:t=`${e.artist_name} - ${new Date().toISOString().split("T")[0]}`;let s=await(await fetch(`https://api.spotify.com/v1/users/${Xt}/playlists`,{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({name:`${t}`,public:!0})})).json(),o=e.songs.map(c=>Kr(c.name,c.original_artist)),n=await Promise.all(o);return await Yr(s.id,n),console.log(`Playlist created: https://open.spotify.com/playlist/${s.id}`),s.id}catch(t){console.error("Error submitting setlist:",t)}}async function Kr(e,t){e.startsWith("#")&&(e=e.slice(1));let r=encodeURIComponent(`${e} ${t}`),s=decodeURIComponent(r);return console.log(`Searching for: ${s}`),(await(await fetch(`https://api.spotify.com/v1/search?q=${s}&type=track&limit=10&market=JP`,{headers:{Authorization:`Bearer ${B}`}})).json()).tracks.items[0].id}async function Yr(e,t){await fetch(`https://api.spotify.com/v1/playlists/${e}/tracks`,{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({uris:t.map(r=>`spotify:track:${r}`)})})}async function Zt(e){return await Oe(),await(await fetch(`https://api.spotify.com/v1/playlists/${e}`,{method:"GET",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"}})).json()}async function er(e,t){await Oe();let r=encodeURIComponent(`${e} ${t}`),s=decodeURIComponent(r);return console.log(`Searching for: ${s}`),await(await fetch(`https://api.spotify.com/v1/search?q=${s}&type=track&limit=10&market=JP`,{headers:{Authorization:`Bearer ${B}`}})).json()}async function tr(e,t){await Oe();let o=(await(await fetch(`https://api.spotify.com/v1/playlists/${e}`,{headers:{Authorization:`Bearer ${B}`}})).json()).name,c=await(await fetch(`https://api.spotify.com/v1/users/${Xt}/playlists`,{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({name:o,public:!0})})).json();for(let l of t)await fetch(`https://api.spotify.com/v1/playlists/${c.id}/tracks`,{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({uris:[`spotify:track:${l}`]})});return console.log(c.id),c.id}async function rr(e,t){await Oe();let r=encodeURIComponent(`${e}`),s=decodeURIComponent(r);console.log(`Searching for: ${s}`);let o={Authorization:`Bearer ${B}`};return t==="livefans"&&(o["Accept-Language"]="ja"),await(await fetch(`https://api.spotify.com/v1/search?q=${s}&type=artist&limit=10&market=JP`,{headers:o})).json()}var C=new ht;C.use("*",Jt());C.use("*",Yt());C.get("/",e=>e.text("hello world"));C.get("/api",e=>e.text("hello!!"));C.get("/api/livefans/:id",async e=>{let t=e.req.param("id"),r=e.req.query("isCover")==="true",s=`https://www.livefans.jp/events/${t}`;if(!s)return e.json({error:"URL parameter is required"},400);try{let o="https://jllyl7rl5d.execute-api.ap-northeast-1.amazonaws.com/Prod/selenium-lambda",n={handler_type:"main",url:s,iscover:r},c=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!c.ok)throw new Error(`Lambda API responded with status: ${c.status}`);let l=await c.json(),a={artist_name:l?.artist_name,location:l?.location,venue:l?.venue,tour_name:l?.tour_name,songs:l?.songs};console.log(a.songs);let h=await ft(a);return a.setlist_id=h,e.json(a)}catch(o){return console.error("Error invoking Lambda:",o),e.json({error:"Failed to invoke Lambda function"},500)}});C.get("/api/setlistfm/:id",async e=>{let t=e.req.param("id"),r,s=e.req.header("Content-Type");s&&s.includes("application/json")?r=(await e.req.json()).setlist_name:r=(await e.req.parseBody()).setlist_name;let o=e.req.query("isCover")==="true",n=e.req.query("isTape")==="true",c=`https://api.setlist.fm/rest/1.0/setlist/${t}`,l={"x-api-key":"rvH9s-nOQE4FOGgLByWj1VfmjzqIaEt5Q8wB",Accept:"application/json"};try{console.log(`Fetching setlist with ID: ${t}`);let a=await fetch(c,{headers:l});if(!a.ok)throw console.error(`HTTP error! status: ${a.status}`),new Error(`HTTP error! status: ${a.status}`);let h=await a.json();console.log("Fetched data:",h);let d=h.artist.name,g=new Date(h.eventDate.split("-").reverse().join("-")),y=h.venue,R=y.city,w=R.country.name,j=`${R.name}, ${w}`,S=y.name,Q=h.tour?.name||"",G=[];h.sets.set.forEach(Ae=>{Ae.song.forEach(L=>{let H=L.name,Qe=L.tape||!1,k="cover"in L,ge=H.split(" / ");for(let pt of ge){let sr=k?L.cover.name:d,Ge={name:pt,original_artist:sr,is_tape:Qe,is_cover:k};Ge.is_tape||(!o||!Ge.is_cover)&&G.push(Ge)}})});let O={artist_name:d,event_date:g,location:j,venue:S,tour_name:Q,songs:G,setlist_id:t},me=await ft(O);return O.setlist_id=me,e.json(O)}catch(a){return console.error("Error fetching setlist:",a),e.json({error:"Failed to fetch setlist"},500)}});C.get("/api/modify/:id",async e=>{let t=e.req.param("id"),r=await Zt(t);return e.json(r)});C.get("/api/song/search/:artist/:name",async e=>{let t=e.req.param("name")||"",r=e.req.param("artist")||"",s=await er(t,r);return e.json(s)});C.get("/api/artist/search",async e=>{let t=e.req.query("q")||"",r=e.req.query("site")||"";console.log(r);let s=await rr(t,r);return e.json(s)});C.post("/api/recreate/playlist/:id",async e=>{let t=e.req.param("id"),r=JSON.parse(await e.req.text());console.log(r);let s=await tr(t,r);return e.json(s)});C.get("/api/fetch-html/setlistfm",async e=>{try{let t=e.req.query("artist")||"",r=encodeURIComponent(t).replace(/%20/g,"+"),s={"x-api-key":"rvH9s-nOQE4FOGgLByWj1VfmjzqIaEt5Q8wB",Accept:"application/json"},o=`https://api.setlist.fm/rest/1.0/search/artists?artistName=${r}&sort=relevance`,l=(await(await fetch(o,{headers:s})).json()).artist[0].mbid,h=await(await fetch(`https://api.setlist.fm/rest/1.0/artist/${l}/setlists`,{headers:s})).json();return console.log(h),e.json(h)}catch(t){return console.error("Error fetching HTML:",t),e.text("Error fetching HTML",500)}});C.get("/api/fetch-html/livefans",async e=>{try{let t=e.req.query("artist")||"",s=`https://www.livefans.jp/search?option=1&keyword=${encodeURIComponent(t).replace(/%20/g,"+")}&genre=all`,o={handler_type:"sub",url:s},c=await fetch("https://pur2p81urh.execute-api.ap-northeast-1.amazonaws.com/default/selenium-lambda",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!c.ok)throw new Error(`Lambda API responded with status: ${c.status}`);let l=await c.json();return console.log(l),e.json(l)}catch(t){return console.error("Error fetching HTML:",t),e.text("Error fetching HTML",500)}});var Xr=ut(C),Zr=C;0&&(module.exports={handler});
//# sourceMappingURL=app.js.map
